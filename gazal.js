const { downloadContentFromMessage } = require('@whiskeysockets/baileys');

module.exports = {
    command: 'شعر',
    async execute(sock, m) {
        try {
            // مجموعة أشعار متنوعة مع تركيز على الشعراء المطلوبين
            const poems = [
                // قصائد جديدة لأمرئ القيس
                {
                    era: "العصر الجاهلي",
                    poet: "امرؤ القيس",
                    verses: [
                        "أفاطمَ مهلًا بعضَ هذا التدللِ",
                        "وإن كنتِ قد أزمعتِ صرمي فأجملي",
                        "وإن تكُ قد ساءتكِ مني خليقةٌ",
                        "فسلي ثيابي من ثيابكِ تنسلي"
                    ]
                },
                {
                    era: "العصر الجاهلي",
                    poet: "امرؤ القيس",
                    verses: [
                        "بكى صاحبي لما رأى الدرب دونه",
                        "وأيقن أنا لاحقان بقيصرا",
                        "فقلت له لا تبكِ عينك إنما",
                        "نحاول ملكًا أو نموت فنعذرا"
                    ]
                },
                {
                    era: "العصر الجاهلي",
                    poet: "امرؤ القيس",
                    verses: [
                        "وليلٍ كمَوجِ البحر أرخى سدولَه",
                        "عليَّ بأنواعِ الهمومِ ليبتلي",
                        "فقلتُ له لما تمطى بصُلبِهِ",
                        "وأردف أعجازًا وناءَ بكَلْكَلِ"
                    ]
                },
                {
                    era: "العصر الجاهلي",
                    poet: "امرؤ القيس",
                    verses: [
                        "كأني لم أرَ قبلي سحابةً",
                        "بليلٍ تهللتْ نجومها",
                        "إذا ما الثريا في سمائها",
                        "تأودتْ غصونًا في مجامعها"
                    ]
                },
                {
                    era: "العصر الجاهلي",
                    poet: "امرؤ القيس",
                    verses: [
                        "ألا عم صباحًا أيها الطلل البالي",
                        "وهل يعمن من كان في العيش خالي",
                        "بكيتُ حتى كادتْ دموعي تسبقني",
                        "على الخدّ حتى لستُ أدري أتبكي"
                    ]
                },

                // قصائد جديدة لعنترة بن شداد
                {
                    era: "العصر الجاهلي",
                    poet: "عنترة بن شداد",
                    verses: [
                        "إنّي امرؤٌ من خيرِ عبسٍ منصبًا",
                        "شطري وأحمي سائري بالمنصلِ",
                        "إذا الكماةُ نزعوا أقرانَ درعهم",
                        "نزعتُ ولم أبدَ لهم بالمثقلِ"
                    ]
                },
                {
                    era: "العصر الجاهلي",
                    poet: "عنترة بن شداد",
                    verses: [
                        "لا تسقني ماءَ الحياةِ بذلةٍ",
                        "بل فاسقني بالعزّ كأسَ الحنظلِ",
                        "ماءُ الحياةِ بذلةٍ كجهنمِ",
                        "وجهنمُ بالعزِّ أطيبُ منزلِ"
                    ]
                },
                {
                    era: "العصر الجاهلي",
                    poet: "عنترة بن شداد",
                    verses: [
                        "ولقد ذكرتكِ والرماحُ نواهلٌ",
                        "مني وبيضُ الهندِ تقطرُ من دمي",
                        "فوددتُ تقبيلَ السيوفِ لأنها",
                        "لمعتْ كبارقِ ثغرِكِ المتبسمِ"
                    ]
                },
                {
                    era: "العصر الجاهلي",
                    poet: "عنترة بن شداد",
                    verses: [
                        "أقيموا بني عمّي صدورَ مطيكم",
                        "فإني إلى قومٍ سواكم لأميلُ",
                        "فقد حمتِ الحاجاتُ والليلُ مُمعنٌ",
                        "وطارَ هواها في الصباحِ الأصيلُ"
                    ]
                },
                {
                    era: "العصر الجاهلي",
                    poet: "عنترة بن شداد",
                    verses: [
                        "إذا شتمتني عبسةٌ شتمتُ فردًا",
                        "وإن ضربتني في الوغى ضربت اثنينِ",
                        "وإن نازلوني نازلتُ فرسانها",
                        "وإن حادثوني حادثتُ بفرسانِ"
                    ]
                },

                // قصائد جديدة للمتنبي
                {
                    era: "العصر العباسي",
                    poet: "المتنبي",
                    verses: [
                        "أُغَالِي فِي الثَّمَنِ الَّذِي أَتَعَزَّزُ بِهِ",
                        "وَأَضَعُ مَالِي حَيْثُ يَسْتَوْجِبُ الْوَضْعُ",
                        "وَلَوْ كُنْتُ أَمْلِكُ كُلَّ مَا فِي الْأَرْضِ مِنْ مَالٍ",
                        "لَرَأَيْتُ عِزِّي فِي مَذَلَّتِي وَالْخَسْعُ"
                    ]
                },
                {
                    era: "العصر العباسي",
                    poet: "المتنبي",
                    verses: [
                        "وَمَا التِّيهُ طِبِّي فِيهِمْ وَلكِنْ",
                        "تَيَمَّمْتُهُ وَالرَّأْيُ مُفْتَرَقُ",
                        "وَلَوْ كُنْتُ أَعْلَمُ الْغَيْبَ لِانْفَرَجَتْ",
                        "عَنِ الدَّهْرِ أَسْبَابٌ وَمَا يَتَّسِعُ"
                    ]
                },
                {
                    era: "العصر العباسي",
                    poet: "المتنبي",
                    verses: [
                        "إذا أنت أكرمت الكريم ملكته",
                        "وإن أنت أكرمت اللئيم تمردا",
                        "وما نيل المطالب بالتمني",
                        "ولكن تؤخذ الدنيا غلابا"
                    ]
                },
                {
                    era: "العصر العباسي",
                    poet: "المتنبي",
                    verses: [
                        "ذو العقل يشقى في النعيم بعقله",
                        "وأخو الجهالة في الشقاوة ينعم",
                        "فإن ذا داءٌ لا دواءً له",
                        "وذا داءٌ في غير أطباءٍ يدوم"
                    ]
                },
                {
                    era: "العصر العباسي",
                    poet: "المتنبي",
                    verses: [
                        "أنا الذي نظر الأعمى إلى أدبي",
                        "وأسمعت كلماتي من به صمم",
                        "الخيل والليل والبيداء تعرفني",
                        "والسيف والرمح والقرطاس والقلم"
                    ]
                },

                // قصائد متنوعة من شعراء آخرين للحفاظ على التنوع
                {
                    era: "العصر الحديث",
                    poet: "نزار قباني",
                    verses: [
                        "يا جارة الوادي طويلٌ عليكِ الانتظار",
                        "والليلُ يطويني ويطوي النار في قرارة الجمرِ",
                        "أنا الذي أسكرتني شفتاكِ في السحرِ",
                        "فلماذا تمنعين عني مدامع المطرِ؟"
                    ]
                },
                {
                    era: "العصر الحديث",
                    poet: "محمود درويش",
                    verses: [
                        "سَجِّلْ أنا عربي",
                        "ورَقْمُ بطاقتي خمسونَ ألف",
                        "وأطفالي ثمانيةٌ",
                        "وتاسعهم سيأتي بعدَ صيف",
                        "فهلْ تغضبْ؟"
                    ]
                },
                {
                    era: "العصر العباسي",
                    poet: "أبو تمام",
                    verses: [
                        "السَّيْفُ أَصْدَقُ إِنْبَاءً مِنَ الكُتُبِ",
                        "فِي حَدِّهِ الحَدُّ بَيْنَ الجِدِّ وَاللَّعِبِ",
                        "بيضُ الصَّفَائِحِ لاَ سُودُ الصَّحَائِفِ فِي",
                        "مُتُونِهِنَّ جَلاءُ الشَّكِّ وَالرَّيَبِ"
                    ]
                },
                {
                    era: "العصر الأندلسي",
                    poet: "ابن زيدون",
                    verses: [
                        "أَضْحَى التَّنَائِي بَدِيْلاً مِنْ تَدَانِينَا",
                        "وَنَابَ عَنْ طِيْبِ لُقْيَانَا تَجَافِينَا",
                        "ألاّ وَقَدْ حَانَ صُبْحُ البَيْنِ صَبَّحَنَا",
                        "حِيْنَ فَقَامَ بِنَا لِلْحَيْنِ نَاعِينَا"
                    ]
                }
            ];

            // اختيار قصيدة عشوائية
            const randomPoem = poems[Math.floor(Math.random() * poems.length)];
            
            // تنسيق الأبيات بشكل جميل
            let formattedPoem = `📜 *${randomPoem.era}* - ${randomPoem.poet}\n\n`;
            formattedPoem += randomPoem.verses.join('\n');
            
            // إضافة هاشتاقات خاصة للشعراء المميزين
            const specialPoets = ["امرؤ القيس", "عنترة بن شداد", "المتنبي"];
            if (specialPoets.includes(randomPoem.poet)) {
                formattedPoem += `\n\n✨ #شعر_${randomPoem.poet.replace(' ', '_')} #عظماء_الشعر`;
            } else {
                formattedPoem += `\n\n✨ #شعر #أدب #${randomPoem.era.replace(' ', '_')}`;
            }

            // إرسال الشعر
            await sock.sendMessage(m.key.remoteJid, {
                text: formattedPoem,
                contextInfo: {
                    mentionedJid: [m.sender],
                    forwardingScore: 999,
                    isForwarded: true
                }
            }, { quoted: m });

        } catch (error) {
            console.error('شعر error:', error);
            await sock.sendMessage(m.key.remoteJid, {
                text: '❌ حدث خطأ أثناء جلب الشعر. يرجى المحاولة لاحقًا.'
            }, { quoted: m });
        }
    }
};