const triviaGames = {};

const questions = [
  { q: 'Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ù…ØµØ±ØŸ', a: 'Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± ÙƒÙˆÙƒØ¨ ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø´Ù…Ø³ÙŠØ©ØŸ', a: 'Ø§Ù„Ù…Ø´ØªØ±ÙŠ' },
  { q: 'ÙƒÙ… Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ØŸ', a: '7' },
  { q: 'Ù…Ù† Ù‡Ùˆ Ù…Ø®ØªØ±Ø¹ Ø§Ù„Ù…ØµØ¨Ø§Ø­ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØŸ', a: 'ØªÙˆÙ…Ø§Ø³ Ø¥Ø¯ÙŠØ³ÙˆÙ†' },
  { q: 'Ù…Ø§ Ù‡ÙŠ Ù„ØºØ© Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ ØªØ·ÙˆÙŠØ± Ù‡Ø°Ø§ Ø§Ù„Ø¨ÙˆØªØŸ', a: 'Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø­ÙŠÙˆØ§Ù† Ø§Ù„Ø°ÙŠ ÙŠØ±Ù…Ø² Ù„Ù‡ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ØŸ', a: 'Ø¯Ù„ÙÙŠÙ†' },
  { q: 'Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ© ÙÙŠ Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ØŸ', a: 'Ø§Ù„ÙŠÙ†' },
  { q: 'Ù…Ø§ Ø§Ø³Ù… Ø£Ø·ÙˆÙ„ Ù†Ù‡Ø± ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ', a: 'Ø§Ù„Ù†ÙŠÙ„' },
  { q: 'ÙÙŠ Ø£ÙŠ Ù‚Ø§Ø±Ø© ØªÙ‚Ø¹ Ù…ØµØ±ØŸ', a: 'Ø£ÙØ±ÙŠÙ‚ÙŠØ§' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø£ÙƒØ¨Ø± Ù…Ø­ÙŠØ· ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ', a: 'Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù‡Ø§Ø¯Ø¦' },
  { q: 'Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© ÙØ±Ù†Ø³Ø§ØŸ', a: 'Ø¨Ø§Ø±ÙŠØ³' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ±Ù…Ø² Ù„Ù‡ Ø¨Ø§Ù„Ø±Ù…Ø² OØŸ', a: 'Ø§Ù„Ø£ÙƒØ³Ø¬ÙŠÙ†' },
  { q: 'ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ', a: '7' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø£Ø³Ø±Ø¹ Ø­ÙŠÙˆØ§Ù† Ø¨Ø±ÙŠØŸ', a: 'Ø§Ù„ÙÙ‡Ø¯' },
  { q: 'Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø±Ø³Ù…ÙŠØ© ÙÙŠ Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„ØŸ', a: 'Ø§Ù„Ø¨Ø±ØªØºØ§Ù„ÙŠØ©' },
  { q: 'Ù…Ù† Ù‡Ùˆ Ù…Ø¤Ù„Ù Ø±ÙˆØ§ÙŠØ© "Ø§Ù„Ø£Ù…ÙŠØ± Ø§Ù„ØµØºÙŠØ±"ØŸ', a: 'Ø£Ù†Ø·ÙˆØ§Ù† Ø¯Ùˆ Ø³Ø§Ù†Øª Ø¥ÙƒØ²ÙˆØ¨ÙŠØ±ÙŠ' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø¹Ø¯Ø¯ Ø£Ù„ÙˆØ§Ù† Ù‚ÙˆØ³ Ù‚Ø²Ø­ØŸ', a: '7' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± Ù…Ø­ÙŠØ· ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ', a: 'Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù‡Ø§Ø¯Ø¦' },
  { q: 'Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ØŸ', a: 'Ø·ÙˆÙƒÙŠÙˆ' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø£Ø·ÙˆÙ„ Ø¬Ø¨Ù„ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ', a: 'Ø¥ÙŠÙØ±Ø³Øª' },
  { q: 'Ù…Ù† Ù‡Ùˆ Ø£ÙˆÙ„ Ø±Ø¦ÙŠØ³ Ù„Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©ØŸ', a: 'Ø¬ÙˆØ±Ø¬ ÙˆØ§Ø´Ù†Ø·Ù†' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ø£Ø­Ù…Ø±ØŸ', a: 'Ø§Ù„Ù…Ø±ÙŠØ®' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± Ø­ÙŠÙˆØ§Ù† Ø¹Ù„Ù‰ ÙˆØ¬Ù‡ Ø§Ù„Ø£Ø±Ø¶ØŸ', a: 'Ø§Ù„Ø­ÙˆØª Ø§Ù„Ø£Ø²Ø±Ù‚' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø£Ø·ÙˆÙ„ Ù†Ù‡Ø± ÙÙŠ Ø£ÙØ±ÙŠÙ‚ÙŠØ§ØŸ', a: 'Ø§Ù„Ù†ÙŠÙ„' },
  { q: 'ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ ÙØ±ÙŠÙ‚ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…ØŸ', a: '11' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…Ù„Ø© ÙÙŠ Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©ØŸ', a: 'Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø£Ø³Ø±Ø¹ Ø·Ø§Ø¦Ø± ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ', a: 'Ø§Ù„ØµÙ‚Ø±' },
  { q: 'Ù…Ù† Ù‡Ùˆ Ù…ÙƒØªØ´Ù Ø£Ù…Ø±ÙŠÙƒØ§ØŸ', a: 'ÙƒØ±ÙŠØ³ØªÙˆÙØ± ÙƒÙˆÙ„ÙˆÙ…Ø¨ÙˆØ³' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± Ù‚Ø§Ø±Ø© Ù…Ù† Ø­ÙŠØ« Ø§Ù„Ù…Ø³Ø§Ø­Ø©ØŸ', a: 'Ø¢Ø³ÙŠØ§' },
  { q: 'Ù…Ø§ Ù‡ÙŠ Ø£ØµØºØ± Ø¯ÙˆÙ„Ø© ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ', a: 'Ø§Ù„ÙØ§ØªÙŠÙƒØ§Ù†' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙˆØ§ÙƒØ¨ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ù…Ø³ÙŠØŸ', a: '8' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„Ø¨Ø­ÙŠØ±Ø© Ø§Ù„Ø£ÙƒØ¨Ø± ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ', a: 'Ø¨Ø­ÙŠØ±Ø© Ø³ÙˆØ¨ÙŠØ±ÙŠÙˆØ±' },
  { q: 'Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŸ', a: 'Ø§Ù„Ø±ÙŠØ§Ø¶' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø£Ø·ÙˆÙ„ Ù†Ù‡Ø± ÙÙŠ Ø¢Ø³ÙŠØ§ØŸ', a: 'Ø§Ù„ÙŠØ§Ù†ØºØªØ³ÙŠ' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± ØµØ­Ø±Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ', a: 'Ø§Ù„ØµØ­Ø±Ø§Ø¡ Ø§Ù„ÙƒØ¨Ø±Ù‰' },
  { q: 'Ù…Ù† Ù‡Ùˆ Ù…Ø¤Ø³Ø³ Ø´Ø±ÙƒØ© Ù…Ø§ÙŠÙƒØ±ÙˆØ³ÙˆÙØªØŸ', a: 'Ø¨ÙŠÙ„ ØºÙŠØªØ³' },
  { q: 'Ù…Ø§ Ù‡ÙŠ Ù„ØºØ© Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù„ØªØ·ÙˆÙŠØ± ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯ØŸ', a: 'Ø¬Ø§ÙØ§' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø¹Ø¯Ø¯ Ø£Ø³Ù†Ø§Ù† Ø§Ù„Ø¥Ù†Ø³Ø§Ù† Ø§Ù„Ø¨Ø§Ù„ØºØŸ', a: '32' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø£Ø·ÙˆÙ„ Ù†Ù‡Ø± ÙÙŠ Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©ØŸ', a: 'Ø§Ù„Ø£Ù…Ø§Ø²ÙˆÙ†' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± ÙƒÙˆÙƒØ¨ Ù‚Ø²Ù… ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ù…Ø³ÙŠØŸ', a: 'Ø¨Ù„ÙˆØªÙˆ' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ©ØŸ', a: 'Ù„Ù†Ø¯Ù†' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø£Ø³Ø±Ø¹ Ø­ÙŠÙˆØ§Ù† Ø¨Ø­Ø±ÙŠØŸ', a: 'Ø³Ù…Ùƒ Ø§Ù„Ø´Ø±Ø§Ø¹' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø£Ø´Ù‡Ø± Ù„ÙˆØ­Ø© Ø±Ø³Ù…Ù‡Ø§ Ù„ÙŠÙˆÙ†Ø§Ø±Ø¯Ùˆ Ø¯Ø§ÙÙ†Ø´ÙŠØŸ', a: 'Ø§Ù„Ù…ÙˆÙ†Ø§Ù„ÙŠØ²Ø§' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„Ø­ÙŠÙˆØ§Ù† Ø§Ù„ÙˆØ·Ù†ÙŠ ÙÙŠ Ø£Ø³ØªØ±Ø§Ù„ÙŠØ§ØŸ', a: 'Ø§Ù„ÙƒÙ†ØºØ±' },
  { q: 'ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø³Ø§Ø¨ÙŠØ¹ Ø§Ù„Ø³Ù†Ø©ØŸ', a: '52' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø°ÙŠ ÙŠÙØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ÙˆÙ…ØµØ±ØŸ', a: 'Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±' },
  { q: 'Ù…Ø§ Ù‡ÙŠ ÙˆØ­Ø¯Ø© Ù‚ÙŠØ§Ø³ Ø´Ø¯Ø© Ø§Ù„ØµÙˆØªØŸ', a: 'Ø§Ù„Ø¯ÙŠØ³ÙŠØ¨Ù„' },
  { q: 'Ù…Ù† Ù‡Ùˆ Ù…Ø¤Ù„Ù Ù…Ø³Ø±Ø­ÙŠØ© "Ø±ÙˆÙ…ÙŠÙˆ ÙˆØ¬ÙˆÙ„ÙŠÙŠØª"ØŸ', a: 'ÙˆÙ„ÙŠØ§Ù… Ø´ÙƒØ³Ø¨ÙŠØ±' },
  { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ø±Ø© Ø§Ù„ØªÙŠ ØªÙ‚Ø¹ ÙÙŠÙ‡Ø§ Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„ØŸ', a: 'Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©' },
  { q: 'Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ© ÙÙŠ Ù…ØµØ±ØŸ', a: 'Ø§Ù„Ø¬Ù†ÙŠÙ‡' },
];

module.exports = {
  command: 'Ø³Ø¤Ø§Ù„Ù„',
  description: 'Ù„Ø¹Ø¨Ø© Ø³Ø¤Ø§Ù„ ÙˆØ¬ÙˆØ§Ø¨ ØªÙØ§Ø¹Ù„ÙŠØ©',
  category: 'Ø£Ù„Ø¹Ø§Ø¨',

  async execute(sock, msg, args) {
    const chatId = msg.key.remoteJid;

    if (triviaGames[chatId]) {
      return sock.sendMessage(chatId, { text: 'âŒ Ù‡Ù†Ø§Ùƒ Ø³Ø¤Ø§Ù„ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¢Ù†ØŒ Ø±Ø¬Ø§Ø¡Ù‹ Ø£Ø¬Ø¨ÙˆØ§ Ø¹Ù„ÙŠÙ‡ Ø£ÙˆÙ„Ø§Ù‹.\n\n--ğ‘·ğ‘¼ğ‘¼ğ‘µğ’€' }, { quoted: msg });
    }

    const randomIndex = Math.floor(Math.random() * questions.length);
    const question = questions[randomIndex];

    triviaGames[chatId] = { answer: question.a.toLowerCase(), timeout: null };

    await sock.sendMessage(chatId, { text: `â“ Ø§Ù„Ø³Ø¤Ø§Ù„: ${question.q}\nÙ„Ø¯ÙŠÙƒ 20 Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©!\n\n--ğ‘·ğ‘¼ğ‘¼ğ‘µğ’€` }, { quoted: msg });

    let answered = false;

    const handler = async ({ messages }) => {
      const reply = messages[0];
      if (!reply.message) return;

      const from = reply.key.remoteJid;
      if (from !== chatId || reply.key.fromMe) return;

      const userAnswer =
        reply.message.conversation ||
        reply.message.extendedTextMessage?.text;

      if (!userAnswer) return;

      const correctAnswer = triviaGames[chatId].answer;

      if (userAnswer.trim().toLowerCase() === correctAnswer) {
        answered = true;
        await sock.sendMessage(chatId, { text: `âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ù‡ÙŠ: *${question.a}*\n\n--ğ‘·ğ‘¼ğ‘¼ğ‘µğ’€` }, { quoted: reply });
        clearTimeout(triviaGames[chatId].timeout);
        delete triviaGames[chatId];
        sock.ev.off('messages.upsert', handler);
      } else {
        await sock.sendMessage(chatId, { text: `âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.\n\n--ğ‘·ğ‘¼ğ‘¼ğ‘µğ’€` }, { quoted: reply });
      }
    };

    sock.ev.on('messages.upsert', handler);

    triviaGames[chatId].timeout = setTimeout(async () => {
      if (!answered) {
        await sock.sendMessage(chatId, { text: `â° Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù‡ÙŠ: *${question.a}*\n\n--ğ‘·ğ‘¼ğ‘¼ğ‘µğ’€` }, { quoted: msg });
      }
      delete triviaGames[chatId];
      sock.ev.off('messages.upsert', handler);
    }, 20000);
  }
};